 /**
 * package E-Commerce WD
 * author Web-Dorado
 * copyright (C) 2014 Web-Dorado. All rights reserved.
 * license GNU/GPLv3 http://www.gnu.org/licenses/gpl-3.0.html
 **/



////////////////////////////////////////////////////////////////////////////////////////
// Events                                                                             //
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
// Constants                                                                          //
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
// Variables                                                                          //
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
// Constructor                                                                        //
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
// Public Methods                                                                     //
////////////////////////////////////////////////////////////////////////////////////////
function selectDiscount(id, name) {
    adminFormSet("discount_id", id);
    adminFormSet("discount_name", name);
}

function selectUsers(users) {
    var userIds = [];
    var userNames = [];

    for (var i = 0; i < users.length; i++) {
        var user = users[i];
        userIds.push(user.id);
        userNames.push(user.name);
    }

    adminFormSet("user_ids", userIds.join(","));
    adminFormSet("user_names", userNames.join("&#13;"));
}


////////////////////////////////////////////////////////////////////////////////////////
// Getters & Setters                                                                  //
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
// Private Methods                                                                    //
////////////////////////////////////////////////////////////////////////////////////////
function showDiscounts(callback) {
    url = "index.php?option=com_ecommercewd" +
        "&controller=discounts" +
        "&task=explore" +
        "&callback=" + callback;
    openPopUp(url);
}

function showUsers(callback) {
    var selectedIds = adminFormGet("user_ids");
    url = "index.php?option=com_ecommercewd" +
        "&controller=users" +
        "&task=explore" +
        "&selected_ids=" + selectedIds +
        "&callback=" + callback;
    openPopUp(url);
}


////////////////////////////////////////////////////////////////////////////////////////
// Listeners                                                                          //
////////////////////////////////////////////////////////////////////////////////////////
function onBtnRemoveDiscountClick(event, obj) {
    selectDiscount(0, "");
}

function onBtnSelectDiscountClick(event, obj) {
    showDiscounts('selectDiscount');
}

function onBtnRemoveUsersClick(event, obj) {
    selectUsers([]);
}

function onBtnSelectUsersClick(event, obj) {
    showUsers("selectUsers");
}